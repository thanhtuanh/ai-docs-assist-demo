{"ast":null,"code":"import _asyncToGenerator from \"/Users/macx116/Documents/projects/dnguyen/bits/render.com/bits-ai-docs-assist/ai-doc-assist/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../document.service\";\nexport class DocumentAnalysisComponent {\n  constructor(documentService) {\n    this.documentService = documentService;\n    this.selectedFile = null;\n    this.isAnalyzing = false;\n    this.analysisResult = null;\n    this.analysisProgress = 0;\n    this.errorMessage = '';\n    this.analysisOptions = {\n      generateSummary: true,\n      extractKeywords: true,\n      generateRecommendations: true,\n      performSentimentAnalysis: true,\n      calculateQualityScore: true,\n      detailedMode: false\n    };\n    this.recommendationFilter = 'all'; // all, high, medium, low\n  }\n\n  ngOnInit() {\n    this.loadAnalysisHistory();\n  }\n\n  onFileSelected(event) {\n    const file = event.target.files[0];\n\n    if (file) {\n      if (!this.validateFile(file)) return;\n      this.selectedFile = file;\n      this.errorMessage = '';\n      this.previewFile(file);\n    }\n  }\n\n  validateFile(file) {\n    const maxSize = 10 * 1024 * 1024; // 10MB\n\n    const allowedTypes = ['application/pdf', 'text/plain', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n\n    if (file.size > maxSize) {\n      this.errorMessage = 'Datei zu groß. Maximale Größe: 10MB';\n      return false;\n    }\n\n    if (!allowedTypes.includes(file.type)) {\n      this.errorMessage = 'Dateityp nicht unterstützt. Erlaubt: PDF, TXT, DOC, DOCX';\n      return false;\n    }\n\n    return true;\n  }\n\n  analyzeDocument() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this.selectedFile) return;\n      _this.isAnalyzing = true;\n      _this.analysisProgress = 0;\n      _this.errorMessage = '';\n\n      try {\n        _this.simulateProgress();\n\n        const result = yield _this.documentService.analyzeDocument(_this.selectedFile, _this.analysisOptions); // 🔁 Konvertierung falls Backend Strings liefert\n\n        if (result.keywords && typeof result.keywords === 'string') {\n          result.keywords = result.keywords.split(',').map(k => k.trim());\n        }\n\n        if (result.suggestedComponents && typeof result.suggestedComponents === 'string') {\n          result.suggestedComponents = result.suggestedComponents.split(',').map(c => c.trim());\n        }\n\n        _this.analysisResult = _this.enhanceAnalysisResult(result);\n        _this.analysisProgress = 100;\n\n        _this.saveToHistory(_this.analysisResult);\n      } catch (error) {\n        _this.errorMessage = 'Fehler bei der Analyse: ' + (error.message || 'Unbekannter Fehler');\n        console.error('Analysis error:', error);\n      } finally {\n        _this.isAnalyzing = false;\n      }\n    })();\n  }\n\n  enhanceAnalysisResult(result) {\n    if (result.recommendations) {\n      result.recommendations = this.sortRecommendations(result.recommendations);\n    }\n\n    if (result.keywords) {\n      result.keywordCategories = this.categorizeKeywords(result.keywords);\n    }\n\n    result.qualityIndicators = this.calculateQualityIndicators(result);\n    return result;\n  }\n\n  sortRecommendations(recommendations) {\n    const priorityOrder = {\n      'KRITISCH': 0,\n      'HOCH': 1,\n      'MITTEL': 2,\n      'NIEDRIG': 3\n    };\n    return recommendations.sort((a, b) => (priorityOrder[a.priority] || 999) - (priorityOrder[b.priority] || 999));\n  }\n\n  categorizeKeywords(keywords) {\n    return {\n      technical: keywords.filter(k => this.isTechnicalTerm(k)),\n      business: keywords.filter(k => this.isBusinessTerm(k)),\n      general: keywords.filter(k => !this.isTechnicalTerm(k) && !this.isBusinessTerm(k))\n    };\n  }\n\n  isTechnicalTerm(term) {\n    const techTerms = ['API', 'REST', 'JSON', 'Database', 'Framework', 'Algorithm'];\n    return techTerms.some(t => term.toLowerCase().includes(t.toLowerCase()));\n  }\n\n  isBusinessTerm(term) {\n    const businessTerms = ['ROI', 'KPI', 'Strategy', 'Revenue', 'Customer', 'Market'];\n    return businessTerms.some(t => term.toLowerCase().includes(t.toLowerCase()));\n  }\n\n  calculateQualityIndicators(result) {\n    return {\n      completeness: this.calculateCompleteness(result),\n      clarity: result.readabilityScore || 0,\n      structure: this.calculateStructureScore(result),\n      technicalDepth: this.calculateTechnicalDepth(result)\n    };\n  }\n\n  calculateCompleteness(result) {\n    let score = 0;\n    if (result.summary) score += 25;\n    if (result.keywords && result.keywords.length > 5) score += 25;\n    if (result.recommendations && result.recommendations.length > 0) score += 25;\n    if (result.sentiment) score += 25;\n    return score;\n  }\n\n  calculateStructureScore(result) {\n    let score = 50;\n    if (result.hasHeadings) score += 20;\n    if (result.hasLists) score += 15;\n    if (result.hasCodeBlocks) score += 15;\n    return Math.min(score, 100);\n  }\n\n  calculateTechnicalDepth(result) {\n    if (!result.keywords) return 0;\n    const technicalTerms = result.keywords.filter(k => this.isTechnicalTerm(k));\n    return Math.min(technicalTerms.length / result.keywords.length * 100, 100);\n  }\n\n  simulateProgress() {\n    const interval = setInterval(() => {\n      if (this.analysisProgress < 90) {\n        this.analysisProgress += Math.random() * 15;\n      } else {\n        clearInterval(interval);\n      }\n    }, 500);\n  }\n\n  getFilteredRecommendations() {\n    var _a;\n\n    if (!((_a = this.analysisResult) === null || _a === void 0 ? void 0 : _a.recommendations)) return [];\n\n    if (this.recommendationFilter === 'all') {\n      return this.analysisResult.recommendations;\n    }\n\n    return this.analysisResult.recommendations.filter(r => r.priority.toLowerCase() === this.recommendationFilter);\n  }\n\n  exportResults() {\n    var _a;\n\n    if (!this.analysisResult) return;\n    const exportData = {\n      timestamp: new Date().toISOString(),\n      filename: (_a = this.selectedFile) === null || _a === void 0 ? void 0 : _a.name,\n      analysis: this.analysisResult\n    };\n    const blob = new Blob([JSON.stringify(exportData, null, 2)], {\n      type: 'application/json'\n    });\n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `analysis_${Date.now()}.json`;\n    link.click();\n  }\n\n  previewFile(file) {\n    const reader = new FileReader();\n\n    reader.onload = e => {\n      console.log('File preview:', e.target.result.substring(0, 500));\n    };\n\n    reader.readAsText(file);\n  }\n\n  loadAnalysisHistory() {\n    const history = localStorage.getItem('analysisHistory');\n\n    if (history) {\n      console.log('Loading history:', JSON.parse(history));\n    }\n  }\n\n  saveToHistory(result) {\n    var _a, _b;\n\n    const history = JSON.parse(localStorage.getItem('analysisHistory') || '[]');\n    history.unshift({\n      timestamp: new Date().toISOString(),\n      filename: (_a = this.selectedFile) === null || _a === void 0 ? void 0 : _a.name,\n      summary: ((_b = result.summary) === null || _b === void 0 ? void 0 : _b.substring(0, 100)) + '...'\n    });\n    localStorage.setItem('analysisHistory', JSON.stringify(history.slice(0, 10)));\n  }\n\n  clearAnalysis() {\n    this.analysisResult = null;\n    this.selectedFile = null;\n    this.analysisProgress = 0;\n    this.errorMessage = '';\n  }\n\n}\n\nDocumentAnalysisComponent.ɵfac = function DocumentAnalysisComponent_Factory(t) {\n  return new (t || DocumentAnalysisComponent)(i0.ɵɵdirectiveInject(i1.DocumentService));\n};\n\nDocumentAnalysisComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DocumentAnalysisComponent,\n  selectors: [[\"app-document-analysis\"]],\n  decls: 1,\n  vars: 0,\n  template: function DocumentAnalysisComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-document-analysis\");\n    }\n  },\n  directives: [DocumentAnalysisComponent],\n  encapsulation: 2\n});","map":{"version":3,"sources":["/Users/macx116/Documents/projects/dnguyen/bits/render.com/bits-ai-docs-assist/ai-doc-assist/frontend/src/app/document-analysis/document-analysis.component.ts"],"names":["i0","i1","DocumentAnalysisComponent","constructor","documentService","selectedFile","isAnalyzing","analysisResult","analysisProgress","errorMessage","analysisOptions","generateSummary","extractKeywords","generateRecommendations","performSentimentAnalysis","calculateQualityScore","detailedMode","recommendationFilter","ngOnInit","loadAnalysisHistory","onFileSelected","event","file","target","files","validateFile","previewFile","maxSize","allowedTypes","size","includes","type","analyzeDocument","simulateProgress","result","keywords","split","map","k","trim","suggestedComponents","c","enhanceAnalysisResult","saveToHistory","error","message","console","recommendations","sortRecommendations","keywordCategories","categorizeKeywords","qualityIndicators","calculateQualityIndicators","priorityOrder","sort","a","b","priority","technical","filter","isTechnicalTerm","business","isBusinessTerm","general","term","techTerms","some","t","toLowerCase","businessTerms","completeness","calculateCompleteness","clarity","readabilityScore","structure","calculateStructureScore","technicalDepth","calculateTechnicalDepth","score","summary","length","sentiment","hasHeadings","hasLists","hasCodeBlocks","Math","min","technicalTerms","interval","setInterval","random","clearInterval","getFilteredRecommendations","_a","r","exportResults","exportData","timestamp","Date","toISOString","filename","name","analysis","blob","Blob","JSON","stringify","url","window","URL","createObjectURL","link","document","createElement","href","download","now","click","reader","FileReader","onload","e","log","substring","readAsText","history","localStorage","getItem","parse","_b","unshift","setItem","slice","clearAnalysis","ɵfac","DocumentAnalysisComponent_Factory","ɵɵdirectiveInject","DocumentService","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","template","DocumentAnalysisComponent_Template","rf","ctx","ɵɵelement","directives","encapsulation"],"mappings":";AAAA,OAAO,KAAKA,EAAZ,MAAoB,eAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,qBAApB;AACA,OAAO,MAAMC,yBAAN,CAAgC;AACnCC,EAAAA,WAAW,CAACC,eAAD,EAAkB;AACzB,SAAKA,eAAL,GAAuBA,eAAvB;AACA,SAAKC,YAAL,GAAoB,IAApB;AACA,SAAKC,WAAL,GAAmB,KAAnB;AACA,SAAKC,cAAL,GAAsB,IAAtB;AACA,SAAKC,gBAAL,GAAwB,CAAxB;AACA,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKC,eAAL,GAAuB;AACnBC,MAAAA,eAAe,EAAE,IADE;AAEnBC,MAAAA,eAAe,EAAE,IAFE;AAGnBC,MAAAA,uBAAuB,EAAE,IAHN;AAInBC,MAAAA,wBAAwB,EAAE,IAJP;AAKnBC,MAAAA,qBAAqB,EAAE,IALJ;AAMnBC,MAAAA,YAAY,EAAE;AANK,KAAvB;AAQA,SAAKC,oBAAL,GAA4B,KAA5B,CAfyB,CAeU;AACtC;;AACDC,EAAAA,QAAQ,GAAG;AACP,SAAKC,mBAAL;AACH;;AACDC,EAAAA,cAAc,CAACC,KAAD,EAAQ;AAClB,UAAMC,IAAI,GAAGD,KAAK,CAACE,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAb;;AACA,QAAIF,IAAJ,EAAU;AACN,UAAI,CAAC,KAAKG,YAAL,CAAkBH,IAAlB,CAAL,EACI;AACJ,WAAKjB,YAAL,GAAoBiB,IAApB;AACA,WAAKb,YAAL,GAAoB,EAApB;AACA,WAAKiB,WAAL,CAAiBJ,IAAjB;AACH;AACJ;;AACDG,EAAAA,YAAY,CAACH,IAAD,EAAO;AACf,UAAMK,OAAO,GAAG,KAAK,IAAL,GAAY,IAA5B,CADe,CACmB;;AAClC,UAAMC,YAAY,GAAG,CAAC,iBAAD,EAAoB,YAApB,EAAkC,oBAAlC,EAAwD,yEAAxD,CAArB;;AACA,QAAIN,IAAI,CAACO,IAAL,GAAYF,OAAhB,EAAyB;AACrB,WAAKlB,YAAL,GAAoB,qCAApB;AACA,aAAO,KAAP;AACH;;AACD,QAAI,CAACmB,YAAY,CAACE,QAAb,CAAsBR,IAAI,CAACS,IAA3B,CAAL,EAAuC;AACnC,WAAKtB,YAAL,GAAoB,0DAApB;AACA,aAAO,KAAP;AACH;;AACD,WAAO,IAAP;AACH;;AACKuB,EAAAA,eAAe,GAAG;AAAA;;AAAA;AACpB,UAAI,CAAC,KAAI,CAAC3B,YAAV,EACI;AACJ,MAAA,KAAI,CAACC,WAAL,GAAmB,IAAnB;AACA,MAAA,KAAI,CAACE,gBAAL,GAAwB,CAAxB;AACA,MAAA,KAAI,CAACC,YAAL,GAAoB,EAApB;;AACA,UAAI;AACA,QAAA,KAAI,CAACwB,gBAAL;;AACA,cAAMC,MAAM,SAAS,KAAI,CAAC9B,eAAL,CAAqB4B,eAArB,CAAqC,KAAI,CAAC3B,YAA1C,EAAwD,KAAI,CAACK,eAA7D,CAArB,CAFA,CAGA;;AACA,YAAIwB,MAAM,CAACC,QAAP,IAAmB,OAAOD,MAAM,CAACC,QAAd,KAA2B,QAAlD,EAA4D;AACxDD,UAAAA,MAAM,CAACC,QAAP,GAAkBD,MAAM,CAACC,QAAP,CAAgBC,KAAhB,CAAsB,GAAtB,EAA2BC,GAA3B,CAAgCC,CAAD,IAAOA,CAAC,CAACC,IAAF,EAAtC,CAAlB;AACH;;AACD,YAAIL,MAAM,CAACM,mBAAP,IAA8B,OAAON,MAAM,CAACM,mBAAd,KAAsC,QAAxE,EAAkF;AAC9EN,UAAAA,MAAM,CAACM,mBAAP,GAA6BN,MAAM,CAACM,mBAAP,CAA2BJ,KAA3B,CAAiC,GAAjC,EAAsCC,GAAtC,CAA2CI,CAAD,IAAOA,CAAC,CAACF,IAAF,EAAjD,CAA7B;AACH;;AACD,QAAA,KAAI,CAAChC,cAAL,GAAsB,KAAI,CAACmC,qBAAL,CAA2BR,MAA3B,CAAtB;AACA,QAAA,KAAI,CAAC1B,gBAAL,GAAwB,GAAxB;;AACA,QAAA,KAAI,CAACmC,aAAL,CAAmB,KAAI,CAACpC,cAAxB;AACH,OAbD,CAcA,OAAOqC,KAAP,EAAc;AACV,QAAA,KAAI,CAACnC,YAAL,GAAoB,8BAA8BmC,KAAK,CAACC,OAAN,IAAiB,oBAA/C,CAApB;AACAC,QAAAA,OAAO,CAACF,KAAR,CAAc,iBAAd,EAAiCA,KAAjC;AACH,OAjBD,SAkBQ;AACJ,QAAA,KAAI,CAACtC,WAAL,GAAmB,KAAnB;AACH;AA1BmB;AA2BvB;;AACDoC,EAAAA,qBAAqB,CAACR,MAAD,EAAS;AAC1B,QAAIA,MAAM,CAACa,eAAX,EAA4B;AACxBb,MAAAA,MAAM,CAACa,eAAP,GAAyB,KAAKC,mBAAL,CAAyBd,MAAM,CAACa,eAAhC,CAAzB;AACH;;AACD,QAAIb,MAAM,CAACC,QAAX,EAAqB;AACjBD,MAAAA,MAAM,CAACe,iBAAP,GAA2B,KAAKC,kBAAL,CAAwBhB,MAAM,CAACC,QAA/B,CAA3B;AACH;;AACDD,IAAAA,MAAM,CAACiB,iBAAP,GAA2B,KAAKC,0BAAL,CAAgClB,MAAhC,CAA3B;AACA,WAAOA,MAAP;AACH;;AACDc,EAAAA,mBAAmB,CAACD,eAAD,EAAkB;AACjC,UAAMM,aAAa,GAAG;AAAE,kBAAY,CAAd;AAAiB,cAAQ,CAAzB;AAA4B,gBAAU,CAAtC;AAAyC,iBAAW;AAApD,KAAtB;AACA,WAAON,eAAe,CAACO,IAAhB,CAAqB,CAACC,CAAD,EAAIC,CAAJ,KAAU,CAACH,aAAa,CAACE,CAAC,CAACE,QAAH,CAAb,IAA6B,GAA9B,KAAsCJ,aAAa,CAACG,CAAC,CAACC,QAAH,CAAb,IAA6B,GAAnE,CAA/B,CAAP;AACH;;AACDP,EAAAA,kBAAkB,CAACf,QAAD,EAAW;AACzB,WAAO;AACHuB,MAAAA,SAAS,EAAEvB,QAAQ,CAACwB,MAAT,CAAgBrB,CAAC,IAAI,KAAKsB,eAAL,CAAqBtB,CAArB,CAArB,CADR;AAEHuB,MAAAA,QAAQ,EAAE1B,QAAQ,CAACwB,MAAT,CAAgBrB,CAAC,IAAI,KAAKwB,cAAL,CAAoBxB,CAApB,CAArB,CAFP;AAGHyB,MAAAA,OAAO,EAAE5B,QAAQ,CAACwB,MAAT,CAAgBrB,CAAC,IAAI,CAAC,KAAKsB,eAAL,CAAqBtB,CAArB,CAAD,IAA4B,CAAC,KAAKwB,cAAL,CAAoBxB,CAApB,CAAlD;AAHN,KAAP;AAKH;;AACDsB,EAAAA,eAAe,CAACI,IAAD,EAAO;AAClB,UAAMC,SAAS,GAAG,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAAwB,UAAxB,EAAoC,WAApC,EAAiD,WAAjD,CAAlB;AACA,WAAOA,SAAS,CAACC,IAAV,CAAeC,CAAC,IAAIH,IAAI,CAACI,WAAL,GAAmBtC,QAAnB,CAA4BqC,CAAC,CAACC,WAAF,EAA5B,CAApB,CAAP;AACH;;AACDN,EAAAA,cAAc,CAACE,IAAD,EAAO;AACjB,UAAMK,aAAa,GAAG,CAAC,KAAD,EAAQ,KAAR,EAAe,UAAf,EAA2B,SAA3B,EAAsC,UAAtC,EAAkD,QAAlD,CAAtB;AACA,WAAOA,aAAa,CAACH,IAAd,CAAmBC,CAAC,IAAIH,IAAI,CAACI,WAAL,GAAmBtC,QAAnB,CAA4BqC,CAAC,CAACC,WAAF,EAA5B,CAAxB,CAAP;AACH;;AACDhB,EAAAA,0BAA0B,CAAClB,MAAD,EAAS;AAC/B,WAAO;AACHoC,MAAAA,YAAY,EAAE,KAAKC,qBAAL,CAA2BrC,MAA3B,CADX;AAEHsC,MAAAA,OAAO,EAAEtC,MAAM,CAACuC,gBAAP,IAA2B,CAFjC;AAGHC,MAAAA,SAAS,EAAE,KAAKC,uBAAL,CAA6BzC,MAA7B,CAHR;AAIH0C,MAAAA,cAAc,EAAE,KAAKC,uBAAL,CAA6B3C,MAA7B;AAJb,KAAP;AAMH;;AACDqC,EAAAA,qBAAqB,CAACrC,MAAD,EAAS;AAC1B,QAAI4C,KAAK,GAAG,CAAZ;AACA,QAAI5C,MAAM,CAAC6C,OAAX,EACID,KAAK,IAAI,EAAT;AACJ,QAAI5C,MAAM,CAACC,QAAP,IAAmBD,MAAM,CAACC,QAAP,CAAgB6C,MAAhB,GAAyB,CAAhD,EACIF,KAAK,IAAI,EAAT;AACJ,QAAI5C,MAAM,CAACa,eAAP,IAA0Bb,MAAM,CAACa,eAAP,CAAuBiC,MAAvB,GAAgC,CAA9D,EACIF,KAAK,IAAI,EAAT;AACJ,QAAI5C,MAAM,CAAC+C,SAAX,EACIH,KAAK,IAAI,EAAT;AACJ,WAAOA,KAAP;AACH;;AACDH,EAAAA,uBAAuB,CAACzC,MAAD,EAAS;AAC5B,QAAI4C,KAAK,GAAG,EAAZ;AACA,QAAI5C,MAAM,CAACgD,WAAX,EACIJ,KAAK,IAAI,EAAT;AACJ,QAAI5C,MAAM,CAACiD,QAAX,EACIL,KAAK,IAAI,EAAT;AACJ,QAAI5C,MAAM,CAACkD,aAAX,EACIN,KAAK,IAAI,EAAT;AACJ,WAAOO,IAAI,CAACC,GAAL,CAASR,KAAT,EAAgB,GAAhB,CAAP;AACH;;AACDD,EAAAA,uBAAuB,CAAC3C,MAAD,EAAS;AAC5B,QAAI,CAACA,MAAM,CAACC,QAAZ,EACI,OAAO,CAAP;AACJ,UAAMoD,cAAc,GAAGrD,MAAM,CAACC,QAAP,CAAgBwB,MAAhB,CAAuBrB,CAAC,IAAI,KAAKsB,eAAL,CAAqBtB,CAArB,CAA5B,CAAvB;AACA,WAAO+C,IAAI,CAACC,GAAL,CAAUC,cAAc,CAACP,MAAf,GAAwB9C,MAAM,CAACC,QAAP,CAAgB6C,MAAzC,GAAmD,GAA5D,EAAiE,GAAjE,CAAP;AACH;;AACD/C,EAAAA,gBAAgB,GAAG;AACf,UAAMuD,QAAQ,GAAGC,WAAW,CAAC,MAAM;AAC/B,UAAI,KAAKjF,gBAAL,GAAwB,EAA5B,EAAgC;AAC5B,aAAKA,gBAAL,IAAyB6E,IAAI,CAACK,MAAL,KAAgB,EAAzC;AACH,OAFD,MAGK;AACDC,QAAAA,aAAa,CAACH,QAAD,CAAb;AACH;AACJ,KAP2B,EAOzB,GAPyB,CAA5B;AAQH;;AACDI,EAAAA,0BAA0B,GAAG;AACzB,QAAIC,EAAJ;;AACA,QAAI,EAAE,CAACA,EAAE,GAAG,KAAKtF,cAAX,MAA+B,IAA/B,IAAuCsF,EAAE,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,EAAE,CAAC9C,eAArE,CAAJ,EACI,OAAO,EAAP;;AACJ,QAAI,KAAK9B,oBAAL,KAA8B,KAAlC,EAAyC;AACrC,aAAO,KAAKV,cAAL,CAAoBwC,eAA3B;AACH;;AACD,WAAO,KAAKxC,cAAL,CAAoBwC,eAApB,CAAoCY,MAApC,CAA2CmC,CAAC,IAAIA,CAAC,CAACrC,QAAF,CAAWW,WAAX,OAA6B,KAAKnD,oBAAlF,CAAP;AACH;;AACD8E,EAAAA,aAAa,GAAG;AACZ,QAAIF,EAAJ;;AACA,QAAI,CAAC,KAAKtF,cAAV,EACI;AACJ,UAAMyF,UAAU,GAAG;AACfC,MAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,WAAX,EADI;AAEfC,MAAAA,QAAQ,EAAE,CAACP,EAAE,GAAG,KAAKxF,YAAX,MAA6B,IAA7B,IAAqCwF,EAAE,KAAK,KAAK,CAAjD,GAAqD,KAAK,CAA1D,GAA8DA,EAAE,CAACQ,IAF5D;AAGfC,MAAAA,QAAQ,EAAE,KAAK/F;AAHA,KAAnB;AAKA,UAAMgG,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACC,IAAI,CAACC,SAAL,CAAeV,UAAf,EAA2B,IAA3B,EAAiC,CAAjC,CAAD,CAAT,EAAgD;AAAEjE,MAAAA,IAAI,EAAE;AAAR,KAAhD,CAAb;AACA,UAAM4E,GAAG,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2BP,IAA3B,CAAZ;AACA,UAAMQ,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAb;AACAF,IAAAA,IAAI,CAACG,IAAL,GAAYP,GAAZ;AACAI,IAAAA,IAAI,CAACI,QAAL,GAAiB,YAAWjB,IAAI,CAACkB,GAAL,EAAW,OAAvC;AACAL,IAAAA,IAAI,CAACM,KAAL;AACH;;AACD3F,EAAAA,WAAW,CAACJ,IAAD,EAAO;AACd,UAAMgG,MAAM,GAAG,IAAIC,UAAJ,EAAf;;AACAD,IAAAA,MAAM,CAACE,MAAP,GAAiBC,CAAD,IAAO;AACnB3E,MAAAA,OAAO,CAAC4E,GAAR,CAAY,eAAZ,EAA6BD,CAAC,CAAClG,MAAF,CAASW,MAAT,CAAgByF,SAAhB,CAA0B,CAA1B,EAA6B,GAA7B,CAA7B;AACH,KAFD;;AAGAL,IAAAA,MAAM,CAACM,UAAP,CAAkBtG,IAAlB;AACH;;AACDH,EAAAA,mBAAmB,GAAG;AAClB,UAAM0G,OAAO,GAAGC,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAAhB;;AACA,QAAIF,OAAJ,EAAa;AACT/E,MAAAA,OAAO,CAAC4E,GAAR,CAAY,kBAAZ,EAAgCjB,IAAI,CAACuB,KAAL,CAAWH,OAAX,CAAhC;AACH;AACJ;;AACDlF,EAAAA,aAAa,CAACT,MAAD,EAAS;AAClB,QAAI2D,EAAJ,EAAQoC,EAAR;;AACA,UAAMJ,OAAO,GAAGpB,IAAI,CAACuB,KAAL,CAAWF,YAAY,CAACC,OAAb,CAAqB,iBAArB,KAA2C,IAAtD,CAAhB;AACAF,IAAAA,OAAO,CAACK,OAAR,CAAgB;AACZjC,MAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,WAAX,EADC;AAEZC,MAAAA,QAAQ,EAAE,CAACP,EAAE,GAAG,KAAKxF,YAAX,MAA6B,IAA7B,IAAqCwF,EAAE,KAAK,KAAK,CAAjD,GAAqD,KAAK,CAA1D,GAA8DA,EAAE,CAACQ,IAF/D;AAGZtB,MAAAA,OAAO,EAAE,CAAC,CAACkD,EAAE,GAAG/F,MAAM,CAAC6C,OAAb,MAA0B,IAA1B,IAAkCkD,EAAE,KAAK,KAAK,CAA9C,GAAkD,KAAK,CAAvD,GAA2DA,EAAE,CAACN,SAAH,CAAa,CAAb,EAAgB,GAAhB,CAA5D,IAAoF;AAHjF,KAAhB;AAKAG,IAAAA,YAAY,CAACK,OAAb,CAAqB,iBAArB,EAAwC1B,IAAI,CAACC,SAAL,CAAemB,OAAO,CAACO,KAAR,CAAc,CAAd,EAAiB,EAAjB,CAAf,CAAxC;AACH;;AACDC,EAAAA,aAAa,GAAG;AACZ,SAAK9H,cAAL,GAAsB,IAAtB;AACA,SAAKF,YAAL,GAAoB,IAApB;AACA,SAAKG,gBAAL,GAAwB,CAAxB;AACA,SAAKC,YAAL,GAAoB,EAApB;AACH;;AAxMkC;;AA0MvCP,yBAAyB,CAACoI,IAA1B,GAAiC,SAASC,iCAAT,CAA2CpE,CAA3C,EAA8C;AAAE,SAAO,KAAKA,CAAC,IAAIjE,yBAAV,EAAqCF,EAAE,CAACwI,iBAAH,CAAqBvI,EAAE,CAACwI,eAAxB,CAArC,CAAP;AAAwF,CAAzK;;AACAvI,yBAAyB,CAACwI,IAA1B,GAAiC,aAAc1I,EAAE,CAAC2I,iBAAH,CAAqB;AAAE5G,EAAAA,IAAI,EAAE7B,yBAAR;AAAmC0I,EAAAA,SAAS,EAAE,CAAC,CAAC,uBAAD,CAAD,CAA9C;AAA2EC,EAAAA,KAAK,EAAE,CAAlF;AAAqFC,EAAAA,IAAI,EAAE,CAA3F;AAA8FC,EAAAA,QAAQ,EAAE,SAASC,kCAAT,CAA4CC,EAA5C,EAAgDC,GAAhD,EAAqD;AAAE,QAAID,EAAE,GAAG,CAAT,EAAY;AACvOjJ,MAAAA,EAAE,CAACmJ,SAAH,CAAa,CAAb,EAAgB,uBAAhB;AACH;AAAE,GAF6D;AAE3DC,EAAAA,UAAU,EAAE,CAAClJ,yBAAD,CAF+C;AAElBmJ,EAAAA,aAAa,EAAE;AAFG,CAArB,CAA/C","sourcesContent":["import * as i0 from \"@angular/core\";\nimport * as i1 from \"../document.service\";\nexport class DocumentAnalysisComponent {\n    constructor(documentService) {\n        this.documentService = documentService;\n        this.selectedFile = null;\n        this.isAnalyzing = false;\n        this.analysisResult = null;\n        this.analysisProgress = 0;\n        this.errorMessage = '';\n        this.analysisOptions = {\n            generateSummary: true,\n            extractKeywords: true,\n            generateRecommendations: true,\n            performSentimentAnalysis: true,\n            calculateQualityScore: true,\n            detailedMode: false\n        };\n        this.recommendationFilter = 'all'; // all, high, medium, low\n    }\n    ngOnInit() {\n        this.loadAnalysisHistory();\n    }\n    onFileSelected(event) {\n        const file = event.target.files[0];\n        if (file) {\n            if (!this.validateFile(file))\n                return;\n            this.selectedFile = file;\n            this.errorMessage = '';\n            this.previewFile(file);\n        }\n    }\n    validateFile(file) {\n        const maxSize = 10 * 1024 * 1024; // 10MB\n        const allowedTypes = ['application/pdf', 'text/plain', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n        if (file.size > maxSize) {\n            this.errorMessage = 'Datei zu groß. Maximale Größe: 10MB';\n            return false;\n        }\n        if (!allowedTypes.includes(file.type)) {\n            this.errorMessage = 'Dateityp nicht unterstützt. Erlaubt: PDF, TXT, DOC, DOCX';\n            return false;\n        }\n        return true;\n    }\n    async analyzeDocument() {\n        if (!this.selectedFile)\n            return;\n        this.isAnalyzing = true;\n        this.analysisProgress = 0;\n        this.errorMessage = '';\n        try {\n            this.simulateProgress();\n            const result = await this.documentService.analyzeDocument(this.selectedFile, this.analysisOptions);\n            // 🔁 Konvertierung falls Backend Strings liefert\n            if (result.keywords && typeof result.keywords === 'string') {\n                result.keywords = result.keywords.split(',').map((k) => k.trim());\n            }\n            if (result.suggestedComponents && typeof result.suggestedComponents === 'string') {\n                result.suggestedComponents = result.suggestedComponents.split(',').map((c) => c.trim());\n            }\n            this.analysisResult = this.enhanceAnalysisResult(result);\n            this.analysisProgress = 100;\n            this.saveToHistory(this.analysisResult);\n        }\n        catch (error) {\n            this.errorMessage = 'Fehler bei der Analyse: ' + (error.message || 'Unbekannter Fehler');\n            console.error('Analysis error:', error);\n        }\n        finally {\n            this.isAnalyzing = false;\n        }\n    }\n    enhanceAnalysisResult(result) {\n        if (result.recommendations) {\n            result.recommendations = this.sortRecommendations(result.recommendations);\n        }\n        if (result.keywords) {\n            result.keywordCategories = this.categorizeKeywords(result.keywords);\n        }\n        result.qualityIndicators = this.calculateQualityIndicators(result);\n        return result;\n    }\n    sortRecommendations(recommendations) {\n        const priorityOrder = { 'KRITISCH': 0, 'HOCH': 1, 'MITTEL': 2, 'NIEDRIG': 3 };\n        return recommendations.sort((a, b) => (priorityOrder[a.priority] || 999) - (priorityOrder[b.priority] || 999));\n    }\n    categorizeKeywords(keywords) {\n        return {\n            technical: keywords.filter(k => this.isTechnicalTerm(k)),\n            business: keywords.filter(k => this.isBusinessTerm(k)),\n            general: keywords.filter(k => !this.isTechnicalTerm(k) && !this.isBusinessTerm(k))\n        };\n    }\n    isTechnicalTerm(term) {\n        const techTerms = ['API', 'REST', 'JSON', 'Database', 'Framework', 'Algorithm'];\n        return techTerms.some(t => term.toLowerCase().includes(t.toLowerCase()));\n    }\n    isBusinessTerm(term) {\n        const businessTerms = ['ROI', 'KPI', 'Strategy', 'Revenue', 'Customer', 'Market'];\n        return businessTerms.some(t => term.toLowerCase().includes(t.toLowerCase()));\n    }\n    calculateQualityIndicators(result) {\n        return {\n            completeness: this.calculateCompleteness(result),\n            clarity: result.readabilityScore || 0,\n            structure: this.calculateStructureScore(result),\n            technicalDepth: this.calculateTechnicalDepth(result)\n        };\n    }\n    calculateCompleteness(result) {\n        let score = 0;\n        if (result.summary)\n            score += 25;\n        if (result.keywords && result.keywords.length > 5)\n            score += 25;\n        if (result.recommendations && result.recommendations.length > 0)\n            score += 25;\n        if (result.sentiment)\n            score += 25;\n        return score;\n    }\n    calculateStructureScore(result) {\n        let score = 50;\n        if (result.hasHeadings)\n            score += 20;\n        if (result.hasLists)\n            score += 15;\n        if (result.hasCodeBlocks)\n            score += 15;\n        return Math.min(score, 100);\n    }\n    calculateTechnicalDepth(result) {\n        if (!result.keywords)\n            return 0;\n        const technicalTerms = result.keywords.filter(k => this.isTechnicalTerm(k));\n        return Math.min((technicalTerms.length / result.keywords.length) * 100, 100);\n    }\n    simulateProgress() {\n        const interval = setInterval(() => {\n            if (this.analysisProgress < 90) {\n                this.analysisProgress += Math.random() * 15;\n            }\n            else {\n                clearInterval(interval);\n            }\n        }, 500);\n    }\n    getFilteredRecommendations() {\n        var _a;\n        if (!((_a = this.analysisResult) === null || _a === void 0 ? void 0 : _a.recommendations))\n            return [];\n        if (this.recommendationFilter === 'all') {\n            return this.analysisResult.recommendations;\n        }\n        return this.analysisResult.recommendations.filter(r => r.priority.toLowerCase() === this.recommendationFilter);\n    }\n    exportResults() {\n        var _a;\n        if (!this.analysisResult)\n            return;\n        const exportData = {\n            timestamp: new Date().toISOString(),\n            filename: (_a = this.selectedFile) === null || _a === void 0 ? void 0 : _a.name,\n            analysis: this.analysisResult\n        };\n        const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const url = window.URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = `analysis_${Date.now()}.json`;\n        link.click();\n    }\n    previewFile(file) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            console.log('File preview:', e.target.result.substring(0, 500));\n        };\n        reader.readAsText(file);\n    }\n    loadAnalysisHistory() {\n        const history = localStorage.getItem('analysisHistory');\n        if (history) {\n            console.log('Loading history:', JSON.parse(history));\n        }\n    }\n    saveToHistory(result) {\n        var _a, _b;\n        const history = JSON.parse(localStorage.getItem('analysisHistory') || '[]');\n        history.unshift({\n            timestamp: new Date().toISOString(),\n            filename: (_a = this.selectedFile) === null || _a === void 0 ? void 0 : _a.name,\n            summary: ((_b = result.summary) === null || _b === void 0 ? void 0 : _b.substring(0, 100)) + '...'\n        });\n        localStorage.setItem('analysisHistory', JSON.stringify(history.slice(0, 10)));\n    }\n    clearAnalysis() {\n        this.analysisResult = null;\n        this.selectedFile = null;\n        this.analysisProgress = 0;\n        this.errorMessage = '';\n    }\n}\nDocumentAnalysisComponent.ɵfac = function DocumentAnalysisComponent_Factory(t) { return new (t || DocumentAnalysisComponent)(i0.ɵɵdirectiveInject(i1.DocumentService)); };\nDocumentAnalysisComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DocumentAnalysisComponent, selectors: [[\"app-document-analysis\"]], decls: 1, vars: 0, template: function DocumentAnalysisComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelement(0, \"app-document-analysis\");\n    } }, directives: [DocumentAnalysisComponent], encapsulation: 2 });\n"]},"metadata":{},"sourceType":"module"}